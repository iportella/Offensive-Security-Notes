# =============================================================================
#  üß† Guia de Threat Hunting no SOC / Threat Hunting Guide for SOC Teams
# =============================================================================
#  Descri√ß√£o / Description:
#  Este guia fornece uma introdu√ß√£o abrangente √†s atividades de threat hunting e
#  monitoramento em Centros de Opera√ß√µes de Seguran√ßa (SOC). Cobre pr√°ticas,
#  ferramentas e queries usadas na detec√ß√£o proativa de amea√ßas.
#
#  This guide provides a comprehensive introduction to threat hunting and
#  monitoring activities within Security Operations Centers (SOC). It covers
#  practices, tools, and queries used for proactive threat detection.
#
#  Autor / Author: Igor Portella
#  Email: igorlllopesport@protonmail.com
#  Vers√£o / Version: 1.0
#  Licen√ßa / License: MIT
#  Aviso / Disclaimer: Apenas para fins educacionais e ambientes autorizados.
#  For educational and authorized use only.
# =============================================================================

## üìò Introdu√ß√£o / Introduction

**PT:** Este documento serve como um guia inicial para a equipe do Centro de Opera√ß√µes de Seguran√ßa (SOC) na execu√ß√£o de suas fun√ß√µes, especialmente no primeiro contato com uma demanda. Apesar de definir atividades-chave, o escopo do trabalho do SOC vai al√©m deste conte√∫do, servindo como ponto de partida.

**EN:** This document serves as an initial guide for the Security Operations Center (SOC) team in carrying out its functions, especially when handling an initial security incident. Although it outlines key activities, the SOC‚Äôs scope extends beyond this document, which serves primarily as a starting point.

---

**PT:** As atividades iniciais s√£o cruciais, com foco na investiga√ß√£o de alertas, conex√µes suspeitas, reputa√ß√£o de IPs, e exposi√ß√£o de servi√ßos na web. Este guia tamb√©m orienta a an√°lise de vers√µes vulner√°veis de servidores, p√°ginas de login p√∫blicas, uso indevido de protocolos, e acesso a sites impr√≥prios.

**EN:** Initial SOC activities are crucial, focusing on alert investigations, suspicious connections, IP reputation, and exposure of services on the web. This guide also provides direction for analyzing vulnerable server versions, public login pages, protocol misuse, and access to inappropriate websites.

---

**PT:** O SOC deve aplicar t√©cnicas proativas de Threat Hunting para identificar atividades maliciosas e aplicar contramedidas.

**EN:** The SOC should apply proactive Threat Hunting techniques to identify malicious activities and apply countermeasures.

---

## üß© O que √© um SOC / What is a SOC

**PT:** Um Centro de Opera√ß√µes de Seguran√ßa (SOC) √© uma estrutura organizacional dedicada √† monitora√ß√£o e resposta a incidentes de seguran√ßa cibern√©tica. Envolve uma equipe de analistas, engenheiros e threat hunters que operam ferramentas como SIEM para detec√ß√£o e mitiga√ß√£o de amea√ßas.

**EN:** A Security Operations Center (SOC) is an organizational structure dedicated to monitoring and responding to cybersecurity incidents. It includes a team of analysts, engineers, and threat hunters operating tools like SIEM to detect and mitigate threats.

---

**PT:** Um dos principais pap√©is do SOC √© a Ca√ßa √†s Amea√ßas (Threat Hunting), atividade proativa voltada √† detec√ß√£o de riscos antes que causem danos. O SOC tamb√©m coordena a resposta a incidentes e contribui para a resili√™ncia da seguran√ßa da informa√ß√£o.

**EN:** One of the SOC‚Äôs primary roles is Threat Hunting, a proactive activity focused on detecting risks before they cause damage. The SOC also manages incident response and contributes to overall information security resilience.

---

**PT:** A equipe do SOC deve manter vigil√¢ncia cont√≠nua dos eventos e garantir a pronta resposta aos incidentes identificados.

**EN:** The SOC team must maintain continuous vigilance of events and ensure prompt response to identified incidents.

## üöÄ Primeiras Atividades / Initial Activities

**PT:** A principal responsabilidade inicial do SOC √© o monitoramento ativo de alertas gerados por sistemas SIEM. Com base nesses alertas, a equipe deve realizar investiga√ß√µes e executar a√ß√µes de Threat Hunting.

**EN:** The SOC's primary initial responsibility is actively monitoring alerts generated by SIEM systems. Based on these alerts, the team should conduct investigations and carry out Threat Hunting actions.

---

**PT:** A atividade de Threat Hunting √© proativa e visa identificar amea√ßas antes que elas comprometam o ambiente. Essa abordagem se diferencia das a√ß√µes reativas, que ocorrem apenas ap√≥s a detec√ß√£o de um incidente.

**EN:** Threat Hunting is a proactive activity aimed at identifying threats before they compromise the environment. This approach differs from reactive actions, which only occur after an incident has been detected.

---

**PT:** A investiga√ß√£o de alertas envolve an√°lise de m√°quina e IP de origem, tipo de conex√£o, arquivos executados, diret√≥rio, hash, IPs externos envolvidos e sua reputa√ß√£o.

**EN:** Alert investigation involves analyzing the source machine and IP, connection type, executed files, directory, file hash, involved external IPs, and their reputation.

---

**PT:** Continua√ß√£o nas pr√≥ximas se√ß√µes abordar√° hunting de conex√µes, exposi√ß√£o de servi√ßos, verifica√ß√£o de vers√µes vulner√°veis e acesso indevido a sites.

**EN:** The continuation in the following sections will cover hunting for connections, service exposure, verification of vulnerable versions, and improper site access.

## üîé Verifica√ß√£o de Alertas / Alert Review

**PT:** Ao revisar alertas, o SOC deve verificar os seguintes pontos:
- IP e hostname de origem;
- Tipo da conex√£o (por exemplo, HTTP, SSH, etc);
- Nome e localiza√ß√£o do arquivo executado;
- Hash do arquivo (MD5, SHA256);
- IPs/dominios externos envolvidos na conex√£o;
- Reputa√ß√£o e geolocaliza√ß√£o dos IPs/dominios externos;
- Se o arquivo ou servi√ßo possui CVE ou exploit p√∫blico.

**EN:** When reviewing alerts, the SOC should check the following:
- Source IP and hostname;
- Type of connection (e.g., HTTP, SSH, etc);
- File name and execution path;
- File hash (MD5, SHA256);
- External IPs/domains involved in the connection;
- Reputation and geolocation of the external IPs/domains;
- Whether the file/service has any CVEs or public exploits.

---

**PT:** Sites √∫teis para consulta:
- [VirusTotal](https://www.virustotal.com/) ‚Äì An√°lise de arquivos e hashes.
- [Arquivo.wiki.br](https://arquivo.wiki.br) ‚Äì Refer√™ncia de arquivos Windows.
- [BrightCloud IP Lookup](https://www.brightcloud.com/tools/url-ip-lookup.php)
- [AbuseIPDB](https://www.abuseipdb.com/)
- [DNS Checker](https://dnschecker.org/all-tools.php)
- [MITRE CVE List](https://cve.mitre.org/)
- [Exploit Database](https://www.exploit-db.com/)

**EN:** Useful sites for reference:
- [VirusTotal](https://www.virustotal.com/) ‚Äì Hash and file scanning.
- [Arquivo.wiki.br](https://arquivo.wiki.br) ‚Äì Windows file reference.
- [BrightCloud IP Lookup](https://www.brightcloud.com/tools/url-ip-lookup.php)
- [AbuseIPDB](https://www.abuseipdb.com/)
- [DNS Checker](https://dnschecker.org/all-tools.php)
- [MITRE CVE List](https://cve.mitre.org/)
- [Exploit Database](https://www.exploit-db.com/)

## üéØ Threat Hunting e Queries / Threat Hunting and Queries

**PT:** O Threat Hunting consiste em identificar proativamente poss√≠veis amea√ßas e pontos vulner√°veis no ambiente. Isso inclui:
- Servi√ßos expostos via rede p√∫blica;
- Conex√µes de origem e destino externas;
- Vers√µes de software/servidores vulner√°veis;
- Sites sem HTTPS;
- Acessos a sites indevidos (apostas, pornografia, torrents).

**EN:** Threat Hunting involves proactively identifying potential threats and vulnerable points in the environment. This includes:
- Services exposed via the public network;
- External source and destination connections;
- Vulnerable software/server versions;
- Sites without HTTPS;
- Access to inappropriate sites (gambling, pornography, torrents).

---

**PT & EN:** Exemplos de queries NetWitness:

```bash
# 1. Conex√µes externas / External source connections
!(ip.src = '10.0.0.0/8' || ip.src = '172.16.0.0/12' || ip.src = '192.168.0.0/16')

# 2. Conex√µes para destinos externos / Connections to external destinations
!(ip.dst = '10.0.0.0/8' || ip.dst = '172.16.0.0/12' || ip.dst = '192.168.0.0/16')

# 3. Servi√ßos expostos / Exposed services via public network
service = 443 && !(ip.src = '10.0.0.0/8' || ip.src = '172.16.0.0/12' || ip.src = '192.168.0.0/16')

# 4. Vers√µes de servidores http / HTTP server versions exposed
http.server exists && !(ip.src = '10.0.0.0/8' || ip.src = '172.16.0.0/12' || ip.src = '192.168.0.0/16')

# 5. Sites sem HTTPS / Sites without HTTPS
service = 80 && !(ip.src = '10.0.0.0/8' || ip.src = '172.16.0.0/12' || ip.src = '192.168.0.0/16')

# 6. Sites impr√≥prios / Inappropriate websites
alias.host contains 'porn' && (ip.src = '10.0.0.0/8' || ip.src = '172.16.0.0/12' || ip.src = '192.168.0.0/16')
alias.host contains 'bet' && (ip.src = '10.0.0.0/8' || ip.src = '172.16.0.0/12' || ip.src = '192.168.0.0/16')
alias.host contains 'torrent' && (ip.src = '10.0.0.0/8' || ip.src = '172.16.0.0/12' || ip.src = '192.168.0.0/16')
```

## ‚úÖ Conclus√£o / Conclusion

**PT:** Este guia abordou pr√°ticas essenciais do SOC com foco em an√°lise de alertas, t√©cnicas de Threat Hunting e exemplos de queries. A seguran√ßa da informa√ß√£o exige vigil√¢ncia cont√≠nua, resposta r√°pida e atualiza√ß√£o constante das amea√ßas emergentes.

**EN:** This guide covered essential SOC practices focusing on alert analysis, Threat Hunting techniques, and example queries. Information security requires continuous monitoring, rapid response, and constant updates on emerging threats.

---

**PT:** Com este guia, analistas de SOC estar√£o melhor preparados para detectar e mitigar riscos em tempo h√°bil.

**EN:** With this guide, SOC analysts will be better equipped to detect and mitigate risks in a timely manner.
